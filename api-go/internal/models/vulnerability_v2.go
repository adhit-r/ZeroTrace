package models

import (
	"time"
)

// VulnerabilityV2 represents an enhanced vulnerability with additional fields
type VulnerabilityV2 struct {
	ID                   string                 `json:"id" db:"id"`
	AgentID              string                 `json:"agent_id" db:"agent_id"`
	Title                string                 `json:"title" db:"title"`
	Description          string                 `json:"description" db:"description"`
	Severity             string                 `json:"severity" db:"severity"`
	Category             string                 `json:"category" db:"category"`
	Status               string                 `json:"status" db:"status"`
	DiscoveredAt         time.Time              `json:"discovered_at" db:"discovered_at"`
	LastSeen             time.Time              `json:"last_seen" db:"last_seen"`
	RiskScore            float64                `json:"risk_score" db:"risk_score"`
	ExploitComplexity    string                 `json:"exploit_complexity" db:"exploit_complexity"`
	AttackVector         string                 `json:"attack_vector" db:"attack_vector"`
	ComplianceFrameworks []string               `json:"compliance_frameworks" db:"compliance_frameworks"`
	Remediation          string                 `json:"remediation" db:"remediation"`
	References           []string               `json:"references" db:"references"`
	Tags                 []string               `json:"tags" db:"tags"`
	Metadata             map[string]interface{} `json:"metadata" db:"metadata"`
	EnrichmentData       map[string]interface{} `json:"enrichment_data" db:"enrichment_data"`
	CreatedAt            time.Time              `json:"created_at" db:"created_at"`
	UpdatedAt            time.Time              `json:"updated_at" db:"updated_at"`
}

// NetworkFinding represents a network security finding
type NetworkFinding struct {
	ID             string                 `json:"id" db:"id"`
	AgentID        string                 `json:"agent_id" db:"agent_id"`
	FindingType    string                 `json:"finding_type" db:"finding_type"`
	Severity       string                 `json:"severity" db:"severity"`
	Host           string                 `json:"host" db:"host"`
	Port           int                    `json:"port" db:"port"`
	Protocol       string                 `json:"protocol" db:"protocol"`
	ServiceName    string                 `json:"service_name" db:"service_name"`
	ServiceVersion string                 `json:"service_version" db:"service_version"`
	Banner         string                 `json:"banner" db:"banner"`
	SSLInfo        SSLInfo                `json:"ssl_info" db:"ssl_info"`
	Description    string                 `json:"description" db:"description"`
	Remediation    string                 `json:"remediation" db:"remediation"`
	DiscoveredAt   time.Time              `json:"discovered_at" db:"discovered_at"`
	Status         string                 `json:"status" db:"status"`
	Metadata       map[string]interface{} `json:"metadata" db:"metadata"`
	CreatedAt      time.Time              `json:"created_at" db:"created_at"`
	UpdatedAt      time.Time              `json:"updated_at" db:"updated_at"`
}

// SSLInfo represents SSL/TLS information
type SSLInfo struct {
	Enabled     bool     `json:"enabled"`
	Version     string   `json:"version"`
	CipherSuite string   `json:"cipher_suite"`
	Certificate CertInfo `json:"certificate"`
	WeakCiphers []string `json:"weak_ciphers"`
	ExpiredCert bool     `json:"expired_cert"`
	SelfSigned  bool     `json:"self_signed"`
}

// CertInfo represents certificate information
type CertInfo struct {
	Subject      string    `json:"subject"`
	Issuer       string    `json:"issuer"`
	ValidFrom    time.Time `json:"valid_from"`
	ValidTo      time.Time `json:"valid_to"`
	SerialNumber string    `json:"serial_number"`
	Fingerprint  string    `json:"fingerprint"`
	KeySize      int       `json:"key_size"`
	SignatureAlg string    `json:"signature_alg"`
}

// ComplianceCheck represents a compliance check
type ComplianceCheck struct {
	ID            string                 `json:"id" db:"id"`
	AgentID       string                 `json:"agent_id" db:"agent_id"`
	Framework     string                 `json:"framework" db:"framework"`
	CheckID       string                 `json:"check_id" db:"check_id"`
	CheckName     string                 `json:"check_name" db:"check_name"`
	Category      string                 `json:"category" db:"category"`
	Severity      string                 `json:"severity" db:"severity"`
	Status        string                 `json:"status" db:"status"`
	Description   string                 `json:"description" db:"description"`
	Remediation   string                 `json:"remediation" db:"remediation"`
	CurrentValue  string                 `json:"current_value" db:"current_value"`
	RequiredValue string                 `json:"required_value" db:"required_value"`
	CheckedAt     time.Time              `json:"checked_at" db:"checked_at"`
	Metadata      map[string]interface{} `json:"metadata" db:"metadata"`
	CreatedAt     time.Time              `json:"created_at" db:"created_at"`
	UpdatedAt     time.Time              `json:"updated_at" db:"updated_at"`
}

// SystemVulnerability represents a system vulnerability
type SystemVulnerability struct {
	ID             string                 `json:"id" db:"id"`
	AgentID        string                 `json:"agent_id" db:"agent_id"`
	VulnType       string                 `json:"vuln_type" db:"vuln_type"`
	Severity       string                 `json:"severity" db:"severity"`
	Title          string                 `json:"title" db:"title"`
	Description    string                 `json:"description" db:"description"`
	OS             string                 `json:"os" db:"os"`
	OSVersion      string                 `json:"os_version" db:"os_version"`
	KernelVersion  string                 `json:"kernel_version" db:"kernel_version"`
	PatchAvailable bool                   `json:"patch_available" db:"patch_available"`
	PatchVersion   string                 `json:"patch_version" db:"patch_version"`
	EOL            bool                   `json:"eol" db:"eol"`
	EOLDate        time.Time              `json:"eol_date" db:"eol_date"`
	Remediation    string                 `json:"remediation" db:"remediation"`
	DiscoveredAt   time.Time              `json:"discovered_at" db:"discovered_at"`
	Status         string                 `json:"status" db:"status"`
	Metadata       map[string]interface{} `json:"metadata" db:"metadata"`
	CreatedAt      time.Time              `json:"created_at" db:"created_at"`
	UpdatedAt      time.Time              `json:"updated_at" db:"updated_at"`
}

// AuthFinding represents an authentication security finding
type AuthFinding struct {
	ID             string                 `json:"id" db:"id"`
	AgentID        string                 `json:"agent_id" db:"agent_id"`
	FindingType    string                 `json:"finding_type" db:"finding_type"`
	Severity       string                 `json:"severity" db:"severity"`
	Title          string                 `json:"title" db:"title"`
	Description    string                 `json:"description" db:"description"`
	User           string                 `json:"user" db:"user"`
	AccountType    string                 `json:"account_type" db:"account_type"`
	PrivilegeLevel string                 `json:"privilege_level" db:"privilege_level"`
	LastLogin      time.Time              `json:"last_login" db:"last_login"`
	PasswordAge    int                    `json:"password_age" db:"password_age"`
	MFAEnabled     bool                   `json:"mfa_enabled" db:"mfa_enabled"`
	Remediation    string                 `json:"remediation" db:"remediation"`
	DiscoveredAt   time.Time              `json:"discovered_at" db:"discovered_at"`
	Status         string                 `json:"status" db:"status"`
	Metadata       map[string]interface{} `json:"metadata" db:"metadata"`
	CreatedAt      time.Time              `json:"created_at" db:"created_at"`
	UpdatedAt      time.Time              `json:"updated_at" db:"updated_at"`
}

// DatabaseFinding represents a database security finding
type DatabaseFinding struct {
	ID           string                 `json:"id" db:"id"`
	AgentID      string                 `json:"agent_id" db:"agent_id"`
	FindingType  string                 `json:"finding_type" db:"finding_type"`
	Severity     string                 `json:"severity" db:"severity"`
	Title        string                 `json:"title" db:"title"`
	Description  string                 `json:"description" db:"description"`
	DatabaseType string                 `json:"database_type" db:"database_type"`
	Host         string                 `json:"host" db:"host"`
	Port         int                    `json:"port" db:"port"`
	Database     string                 `json:"database" db:"database"`
	User         string                 `json:"user" db:"user"`
	IsEncrypted  bool                   `json:"is_encrypted" db:"is_encrypted"`
	IsRemote     bool                   `json:"is_remote" db:"is_remote"`
	Remediation  string                 `json:"remediation" db:"remediation"`
	DiscoveredAt time.Time              `json:"discovered_at" db:"discovered_at"`
	Status       string                 `json:"status" db:"status"`
	Metadata     map[string]interface{} `json:"metadata" db:"metadata"`
	CreatedAt    time.Time              `json:"created_at" db:"created_at"`
	UpdatedAt    time.Time              `json:"updated_at" db:"updated_at"`
}

// APIFinding represents an API security finding
type APIFinding struct {
	ID              string                 `json:"id" db:"id"`
	AgentID         string                 `json:"agent_id" db:"agent_id"`
	FindingType     string                 `json:"finding_type" db:"finding_type"`
	Severity        string                 `json:"severity" db:"severity"`
	Title           string                 `json:"title" db:"title"`
	Description     string                 `json:"description" db:"description"`
	Endpoint        string                 `json:"endpoint" db:"endpoint"`
	Method          string                 `json:"method" db:"method"`
	StatusCode      int                    `json:"status_code" db:"status_code"`
	OWASPTop10      string                 `json:"owasp_top10" db:"owasp_top10"`
	IsAuthenticated bool                   `json:"is_authenticated" db:"is_authenticated"`
	IsRateLimited   bool                   `json:"is_rate_limited" db:"is_rate_limited"`
	HasCORS         bool                   `json:"has_cors" db:"has_cors"`
	Remediation     string                 `json:"remediation" db:"remediation"`
	DiscoveredAt    time.Time              `json:"discovered_at" db:"discovered_at"`
	Status          string                 `json:"status" db:"status"`
	Metadata        map[string]interface{} `json:"metadata" db:"metadata"`
	CreatedAt       time.Time              `json:"created_at" db:"created_at"`
	UpdatedAt       time.Time              `json:"updated_at" db:"updated_at"`
}

// ContainerFinding represents a container security finding
type ContainerFinding struct {
	ID           string                 `json:"id" db:"id"`
	AgentID      string                 `json:"agent_id" db:"agent_id"`
	FindingType  string                 `json:"finding_type" db:"finding_type"`
	Severity     string                 `json:"severity" db:"severity"`
	Title        string                 `json:"title" db:"title"`
	Description  string                 `json:"description" db:"description"`
	ContainerID  string                 `json:"container_id" db:"container_id"`
	ImageName    string                 `json:"image_name" db:"image_name"`
	ImageTag     string                 `json:"image_tag" db:"image_tag"`
	Namespace    string                 `json:"namespace" db:"namespace"`
	PodName      string                 `json:"pod_name" db:"pod_name"`
	IsPrivileged bool                   `json:"is_privileged" db:"is_privileged"`
	HasRootUser  bool                   `json:"has_root_user" db:"has_root_user"`
	NetworkMode  string                 `json:"network_mode" db:"network_mode"`
	Remediation  string                 `json:"remediation" db:"remediation"`
	DiscoveredAt time.Time              `json:"discovered_at" db:"discovered_at"`
	Status       string                 `json:"status" db:"status"`
	Metadata     map[string]interface{} `json:"metadata" db:"metadata"`
	CreatedAt    time.Time              `json:"created_at" db:"created_at"`
	UpdatedAt    time.Time              `json:"updated_at" db:"updated_at"`
}

// AIMLFinding represents an AI/ML security finding
type AIMLFinding struct {
	ID              string                 `json:"id" db:"id"`
	AgentID         string                 `json:"agent_id" db:"agent_id"`
	FindingType     string                 `json:"finding_type" db:"finding_type"`
	Severity        string                 `json:"severity" db:"severity"`
	Title           string                 `json:"title" db:"title"`
	Description     string                 `json:"description" db:"description"`
	ModelName       string                 `json:"model_name" db:"model_name"`
	ModelVersion    string                 `json:"model_version" db:"model_version"`
	Framework       string                 `json:"framework" db:"framework"`
	Vulnerabilities []string               `json:"vulnerabilities" db:"vulnerabilities"`
	BiasScore       float64                `json:"bias_score" db:"bias_score"`
	PrivacyScore    float64                `json:"privacy_score" db:"privacy_score"`
	SecurityScore   float64                `json:"security_score" db:"security_score"`
	Remediation     string                 `json:"remediation" db:"remediation"`
	DiscoveredAt    time.Time              `json:"discovered_at" db:"discovered_at"`
	Status          string                 `json:"status" db:"status"`
	Metadata        map[string]interface{} `json:"metadata" db:"metadata"`
	CreatedAt       time.Time              `json:"created_at" db:"created_at"`
	UpdatedAt       time.Time              `json:"updated_at" db:"updated_at"`
}

// IoTOTFinding represents an IoT/OT security finding
type IoTOTFinding struct {
	ID                string                 `json:"id" db:"id"`
	AgentID           string                 `json:"agent_id" db:"agent_id"`
	FindingType       string                 `json:"finding_type" db:"finding_type"`
	Severity          string                 `json:"severity" db:"severity"`
	Title             string                 `json:"title" db:"title"`
	Description       string                 `json:"description" db:"description"`
	DeviceID          string                 `json:"device_id" db:"device_id"`
	DeviceType        string                 `json:"device_type" db:"device_type"`
	Protocol          string                 `json:"protocol" db:"protocol"`
	IPAddress         string                 `json:"ip_address" db:"ip_address"`
	MACAddress        string                 `json:"mac_address" db:"mac_address"`
	Port              int                    `json:"port" db:"port"`
	IsEncrypted       bool                   `json:"is_encrypted" db:"is_encrypted"`
	HasAuthentication bool                   `json:"has_authentication" db:"has_authentication"`
	Remediation       string                 `json:"remediation" db:"remediation"`
	DiscoveredAt      time.Time              `json:"discovered_at" db:"discovered_at"`
	Status            string                 `json:"status" db:"status"`
	Metadata          map[string]interface{} `json:"metadata" db:"metadata"`
	CreatedAt         time.Time              `json:"created_at" db:"created_at"`
	UpdatedAt         time.Time              `json:"updated_at" db:"updated_at"`
}

// PrivacyFinding represents a privacy security finding
type PrivacyFinding struct {
	ID                  string                 `json:"id" db:"id"`
	AgentID             string                 `json:"agent_id" db:"agent_id"`
	FindingType         string                 `json:"finding_type" db:"finding_type"`
	Severity            string                 `json:"severity" db:"severity"`
	Title               string                 `json:"title" db:"title"`
	Description         string                 `json:"description" db:"description"`
	DataType            string                 `json:"data_type" db:"data_type"`
	Location            string                 `json:"location" db:"location"`
	IsEncrypted         bool                   `json:"is_encrypted" db:"is_encrypted"`
	IsMasked            bool                   `json:"is_masked" db:"is_masked"`
	AccessLevel         string                 `json:"access_level" db:"access_level"`
	RetentionPeriod     string                 `json:"retention_period" db:"retention_period"`
	ComplianceFramework string                 `json:"compliance_framework" db:"compliance_framework"`
	Remediation         string                 `json:"remediation" db:"remediation"`
	DiscoveredAt        time.Time              `json:"discovered_at" db:"discovered_at"`
	Status              string                 `json:"status" db:"status"`
	Metadata            map[string]interface{} `json:"metadata" db:"metadata"`
	CreatedAt           time.Time              `json:"created_at" db:"created_at"`
	UpdatedAt           time.Time              `json:"updated_at" db:"updated_at"`
}

// Web3Finding represents a Web3 security finding
type Web3Finding struct {
	ID              string                 `json:"id" db:"id"`
	AgentID         string                 `json:"agent_id" db:"agent_id"`
	FindingType     string                 `json:"finding_type" db:"finding_type"`
	Severity        string                 `json:"severity" db:"severity"`
	Title           string                 `json:"title" db:"title"`
	Description     string                 `json:"description" db:"description"`
	ContractAddress string                 `json:"contract_address" db:"contract_address"`
	WalletAddress   string                 `json:"wallet_address" db:"wallet_address"`
	Network         string                 `json:"network" db:"network"`
	TransactionHash string                 `json:"transaction_hash" db:"transaction_hash"`
	Vulnerabilities []string               `json:"vulnerabilities" db:"vulnerabilities"`
	RiskScore       float64                `json:"risk_score" db:"risk_score"`
	Remediation     string                 `json:"remediation" db:"remediation"`
	DiscoveredAt    time.Time              `json:"discovered_at" db:"discovered_at"`
	Status          string                 `json:"status" db:"status"`
	Metadata        map[string]interface{} `json:"metadata" db:"metadata"`
	CreatedAt       time.Time              `json:"created_at" db:"created_at"`
	UpdatedAt       time.Time              `json:"updated_at" db:"updated_at"`
}

// VulnerabilityStats represents vulnerability statistics
type VulnerabilityStats struct {
	Total              int                `json:"total"`
	ByCategory         map[string]int     `json:"by_category"`
	BySeverity         map[string]int     `json:"by_severity"`
	ByCompliance       map[string]int     `json:"by_compliance"`
	ByRiskScore        map[string]int     `json:"by_risk_score"`
	Trends             []TrendData        `json:"trends"`
	TopVulnerabilities []TopVulnerability `json:"top_vulnerabilities"`
	ComplianceScore    float64            `json:"compliance_score"`
	RiskScore          float64            `json:"risk_score"`
	LastUpdated        time.Time          `json:"last_updated"`
}

// TrendData represents trend data
type TrendData struct {
	Date     string `json:"date"`
	Count    int    `json:"count"`
	Severity string `json:"severity,omitempty"`
	Category string `json:"category,omitempty"`
}

// TopVulnerability represents top vulnerability
type TopVulnerability struct {
	ID          string  `json:"id"`
	Title       string  `json:"title"`
	Severity    string  `json:"severity"`
	Category    string  `json:"category"`
	Count       int     `json:"count"`
	RiskScore   float64 `json:"risk_score"`
	Description string  `json:"description"`
}

// ComplianceStatus represents compliance status
type ComplianceStatus struct {
	OverallScore    float64                   `json:"overall_score"`
	Frameworks      map[string]FrameworkScore `json:"frameworks"`
	GapAnalysis     []GapAnalysis             `json:"gap_analysis"`
	Recommendations []string                  `json:"recommendations"`
	LastAudit       time.Time                 `json:"last_audit"`
	NextAudit       time.Time                 `json:"next_audit"`
}

// FrameworkScore represents framework score
type FrameworkScore struct {
	Score        float64 `json:"score"`
	TotalChecks  int     `json:"total_checks"`
	PassedChecks int     `json:"passed_checks"`
	FailedChecks int     `json:"failed_checks"`
	Status       string  `json:"status"` // compliant, non_compliant, partial
}

// GapAnalysis represents gap analysis
type GapAnalysis struct {
	Framework   string `json:"framework"`
	Requirement string `json:"requirement"`
	Status      string `json:"status"`
	Gap         string `json:"gap"`
	Remediation string `json:"remediation"`
	Priority    string `json:"priority"`
}
