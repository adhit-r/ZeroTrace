# Data Files Guide

## Required Data Files

### CPE Dictionary (`data/nvdcpe-2.0.tar`)

**Size:** ~682MB  
**Purpose:** Official NVD CPE Dictionary 2.0 used for seeding the Redis database  
**Source:** https://nvd.nist.gov/feeds/json/cpe/2.0/nvdcpe-2.0.tar.gz

**Status:**
- ✅ **Needed locally** for seeding the CPE database
- ❌ **Not in git** (too large, in .gitignore)
- ✅ **Auto-downloaded** when running `bin/import.py --download`

**Location:**
- Default: `enrichment-python/data/nvdcpe-2.0.tar`
- Configurable via `CPE_GUESSER_CPE_PATH` environment variable

**Usage:**
```bash
# The import script will download it automatically if missing
cd cpe-guesser
python3 bin/import.py --download

# Or manually download
wget https://nvd.nist.gov/feeds/json/cpe/2.0/nvdcpe-2.0.tar.gz
gunzip nvdcpe-2.0.tar.gz
mv nvdcpe-2.0.tar ../data/
```

### CVE Data (`cve_data.json`)

**Size:** ~9.8MB  
**Purpose:** Local CVE database for fast lookups  
**Source:** Generated by `scripts/update_cve_data.py`

**Status:**
- ✅ **Needed locally** for CVE enrichment
- ❌ **Not in git** (in .gitignore)
- ✅ **Auto-generated** when running update script

**Usage:**
```bash
# Update CVE data
python scripts/update_cve_data.py
```

## File Locations

```
enrichment-python/
├── data/
│   └── nvdcpe-2.0.tar          # CPE Dictionary (682MB) - Download when needed
├── cve_data.json                # CVE Database (9.8MB) - Generated by script
└── cpe-guesser/
    └── data/                     # Empty (CPE data goes to Redis DB 8)
```

## First-Time Setup

1. **Seed CPE Database:**
   ```bash
   cd cpe-guesser
   python3 bin/import.py --download
   # This will download nvdcpe-2.0.tar to ../data/ if needed
   ```

2. **Update CVE Data:**
   ```bash
   python scripts/update_cve_data.py
   # This will create cve_data.json
   ```

## Notes

- Both files are **ignored by git** (too large)
- Both files are **auto-downloaded/generated** when needed
- CPE dictionary is only needed for **initial seeding**
- After seeding, the data is in **Redis DB 8** (167,573 keys)
- CVE data can be updated periodically using the update script

